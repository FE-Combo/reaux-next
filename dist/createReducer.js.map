{"version":3,"file":"createReducer.js","sourceRoot":"","sources":["../framework/createReducer.ts"],"names":[],"mappings":"AAAA,OAAO,EAAW,eAAe,EAAqB,MAAM,OAAO,CAAC;AACpE,OAAO,EACL,gBAAgB,EAChB,kBAAkB,EAClB,eAAe,EACf,oBAAoB,EACrB,MAAM,QAAQ,CAAC;AAUhB,MAAM,UAAU,cAAc,CAC5B,MAAc,EACd,KAAqB,EACrB,OAAe,gBAAgB;IAE/B,OAAO;QACL,IAAI;QACJ,OAAO,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE;KAC3B,CAAC;AACJ,CAAC;AAED,MAAM,UAAU,eAAe,CAC7B,IAAO,EACP,OAA4B;IAE5B,OAAO;QACL,IAAI;QACJ,OAAO;KACR,CAAC;AACJ,CAAC;AAED,SAAS,UAAU,CACjB,QAA0B,EAAE,EAC5B,MAAuB;IAEvB,IAAI,MAAM,CAAC,IAAI,KAAK,gBAAgB,EAAE;QACpC,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,MAAM,CAAC,OAAwB,CAAC;QACvE,OAAO,EAAE,GAAG,KAAK,EAAE,CAAC,MAAM,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,GAAG,WAAW,EAAE,EAAE,CAAC;KACrE;IACD,OAAO,KAAK,CAAC;AACf,CAAC;AAED,SAAS,aAAa,CACpB,QAA6B,EAAE,EAC/B,MAAuB;IAEvB,MAAM,SAAS,GAAG,EAAE,GAAG,KAAK,EAAE,CAAC;IAC/B,QAAQ,MAAM,CAAC,IAAI,EAAE;QACnB,KAAK,kBAAkB;YACrB,MAAM,EACJ,OAAO,EACP,UAAU,EACX,GAAG,MAAM,CAAC,OAAsC,CAAC;YAClD,CAAC,SAAS,CAAC,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,GAAG,EAAE,CAAC,CAAC;YAC/C,MAAM,KAAK,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YACjD,SAAS,CAAC,OAAO,CAAC,UAAU,GAAG,KAAK,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAC1D,OAAO,SAAS,CAAC;QACnB,KAAK,eAAe;YAClB,MAAM,IAAI,GAAG,MAAM,CAAC,OAAiB,CAAC;YACtC,SAAS,CAAC,IAAI,GAAG,IAAI,CAAC;YACtB,OAAO,SAAS,CAAC;QACnB,KAAK,oBAAoB;YACvB,MAAM,SAAS,GAAG,MAAM,CAAC,OAAoB,CAAC;YAC9C,SAAS,CAAC,SAAS,GAAG,SAAS,CAAC;YAChC,OAAO,SAAS,CAAC;QACnB;YACE,OAAO,KAAK,CAAC;KAChB;AACH,CAAC;AAED,MAAM,UAAU,aAAa;IAC3B,MAAM,QAAQ,GAAsC;QAClD,GAAG,EAAE,UAAU;QACf,MAAM,EAAE,aAAa;KACtB,CAAC;IACF,OAAO,eAAe,CAAC,QAAQ,CAAC,CAAC;AACnC,CAAC","sourcesContent":["import { Reducer, combineReducers, ReducersMapObject } from \"redux\";\nimport {\n  SET_STATE_ACTION,\n  SET_HELPER_LOADING,\n  SET_HELPER_LANG,\n  SET_HELPER_EXCEPTION\n} from \"./util\";\nimport {\n  StateView,\n  ActionType,\n  ActionPayload,\n  StateViewHelperLoadingState,\n  Exception,\n  HelperActionPayload\n} from \"./type\";\n\nexport function setStateAction<State>(\n  module: string,\n  state: Partial<State>,\n  type: string = SET_STATE_ACTION\n): ActionType<ActionPayload> {\n  return {\n    type,\n    payload: { module, state }\n  };\n}\n\nexport function setHelperAction<T>(\n  type: T,\n  payload: HelperActionPayload\n): ActionType<HelperActionPayload> {\n  return {\n    type,\n    payload\n  };\n}\n\nfunction appReducer(\n  state: StateView[\"app\"] = {},\n  action: ActionType<any>\n): StateView[\"app\"] {\n  if (action.type === SET_STATE_ACTION) {\n    const { module, state: moduleState } = action.payload as ActionPayload;\n    return { ...state, [module]: { ...state[module], ...moduleState } };\n  }\n  return state;\n}\n\nfunction helperReducer(\n  state: StateView[\"helper\"] = {},\n  action: ActionType<any>\n): StateView[\"helper\"] {\n  const nextState = { ...state };\n  switch (action.type) {\n    case SET_HELPER_LOADING:\n      const {\n        hasShow,\n        identifier\n      } = action.payload as StateViewHelperLoadingState;\n      !nextState.loading && (nextState.loading = {});\n      const count = nextState.loading[identifier] || 0;\n      nextState.loading.identifier = count + (hasShow ? 1 : -1);\n      return nextState;\n    case SET_HELPER_LANG:\n      const lang = action.payload as string;\n      nextState.lang = lang;\n      return nextState;\n    case SET_HELPER_EXCEPTION:\n      const exception = action.payload as Exception;\n      nextState.exception = exception;\n      return nextState;\n    default:\n      return state;\n  }\n}\n\nexport function createReducer(): Reducer<StateView> {\n  const reducers: ReducersMapObject<StateView, any> = {\n    app: appReducer,\n    helper: helperReducer\n  };\n  return combineReducers(reducers);\n}\n"]}